# Automation
 直感的なスクリプトを追加することにより、簡単にChromeの操作の自動化を実現するアプリケーションです。
 - コマンドプロンプトによる入力

# 登録されている機能 2021/02/14時点
 - 楽天競馬ログイン（環境テスト用）
 - 開始終了日時を指定したn-gateの申請

# 実行環境/仕様モジュール
 - chromeDriver ver88
 - selenium

# 使用方法
コマンドラインでmain.pyを実行
```
$python main.py
```

# 構成
```
├── main.py(実行ファイル)
├── settings.json(設定用ファイル)
│
├── framework
│   ├── businessException.py
│   ├── DataUtil.py
│   ├── Driver.py
│   ├── DriverImple.py
│   ├── Func.py
│   └── UserInterface.py
│
└── func
    ├── ConcreteCreator.py
    └── functions
        ├── <func_1>.py
        :
        └── <func_n>.py
```
# 連絡は
開発３部湯原へ
 - y-yuhara@nri.co.jp




# 使い方

1. functionsフォルダの配下に自動化スクリプト（後述）を配置する。
2. ConcreateCreator.pyの11行目に機能名を、createFuncメソッドに機能を追加する。
3. main.pyを実行する。

## **自動化スクリプト**の実装

Funcクラスを継承し、openPage,doFunc,closePageを実装する。
SeleniumのWrapperクラスDriverと、cmdから入力を受け取るUserInterfaceを利用できる。

 - openPageメソッド:
操作するwebページを開く

 - doFuncメソッド:
一連の操作を記述する

 -  closePageメソッド:
webページを閉じる

## 利用できるクラス
利用できるクラスは現状2種類
 - Driver
 - UserInterface

### Driver
 - access(String url)

引数にurlを指定して、そのurlにアクセスします。
 ```
 driver = DriverImple()
 driver.access(url)
 ```
 - pushButton(String Xpath)

 引数にXpathを指定して、要素のボタンを押します。
 ```
 driver = DriverImple()
 driver.pushButton(Xpath)
 ```
 - notCloseAndEnd()

 windowを閉じずに、automationアプリから操作を切り離します。
 ```
 driver = DriverImple()
 driver.notCloseAndEnd()
 ```
 - inputInfo(String Xpath, input)

引数にXpathを指定して、要素に引数inputを入力します。
```
driver = DriverImple()
driver.inputInfo(Xpath, input)
```
 - closeBrowser

ブラウザを閉じます。
```
driver = DriverImple()
driver.closeBrowser()
```
 - waitElementByDisplay(String Xpath)

指定したXpathの要素が表示されるまで、ブラウザ操作を停止します。
```
driver = DriverImple()
driver.waitElementByDisplay(Xpath)
```
 - changeNextTab

 次のタブに遷移します。
 ```
driver = DriverImple()
driver.changeNextTab()
 ```
 - changeLastTab

 出ているタブの最新のものに遷移します。
 ```
 driver = DriverImple()
 driver.changeLastTab()
 ```
 - executeScript(String script)

 引数のjavascriptを実行します。
```
driver = DriverImple()
driver.executeScript(Script)
```
 - getText(String xpath)

引数のxpathの要素の文字列を取得します
```
driver = DriverImple()
driver.text = getText(xpath)
```


### UserInterface
 - start
 ```
 ui = UserInterface()
 ui.start()
 ```
 - end
 ```
 ui = UserInterface()
 ui.end()
 ```
 - inputData(String name)

入力項目名を引数に、「<入力項目名>を入力してください」と入力を受け付けます。戻り値に入力された値の文字列を返却します。
 ```
 ui = UserInterface()
 input = ui.inputData(name)
 ```
 
 - showMessage(String message)

 メッセージを引数に、標準出力にメッセージ内容を出力します。
 ```
 ui = UserInterface()
 ui.showMessage(message)
 ```

# 設計書
## クラス図

## シーケンス図